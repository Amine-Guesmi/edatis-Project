{% extends 'dashbord_elements/base.html' %}
{% load static %}
{% block body %}
<div class="row">
  <div class="col-md-3">
    <div class="card">
      <div class="card-header card-header-info card-header-text">
        <div class="card-icon">
          <i class="material-icons">library_books</i>
        </div>
        <h4 class="card-title">First Date</h4>
      </div>
      <div class="card-body">
        <div class="form-group">
          <input class="form-control" disabled id="firstDate" type="date">
        </div>
      </div>
    </div>
  </div>
  <div class="col-md-3">
    <div class="card">
      <div class="card-header card-header-info card-header-text">
        <div class="card-icon">
          <i class="material-icons">library_books</i>
        </div>
        <h4 class="card-title">Seconde Date</h4>
      </div>
      <div class="card-body">
        <div class="form-group">
          <input class="form-control datepicker" disabled id="secondDate" type="date">
        </div>
      </div>
    </div>
  </div>
  <div class="col-md-6">
    <div class="card">
      <div class="card-header card-header-success card-header-text">
        <div class="card-text">
          <h4 class="card-title">Mail sending id : <span class="mail_sending_id">{{ mail_sending_id }}</span></h4>
        </div>
      </div>
      <div class="card-body">
        <form class="form-inline">
          <div class="form-group mx-sm-3 mb-2">
            <input id="mail_sending_id" class="form-control" placeholder="Mail Sending Id" type="Number" width="30%">
          </div>
          <div class="togglebutton">
            <label><input id="dateOption" type="checkbox"> <span class="toggle"></span> <span><strong>with date(<span class="dataOptiontext" style="color : red">OFF</span>)</strong></span></label>
          </div>&nbsp;&nbsp;&nbsp; <button id="btn-charge" class="btn btn-success mb-1" type="button"><strong>Confirm</strong></button>
        </form>
      </div>
    </div>
  </div>
</div>
<div class="row">
  <div class="col-md-4">
    <div class="card">
      <div class="card-header card-header-icon card-header-rose">
        <div class="card-icon">
          <i class="material-icons">pie_chart</i>
        </div>
        <h4 class="card-title">Stats global For all compane<img class="loading" id="loading-sending-recieved-inqueue" src="{% static 'assets/img/load.gif' %}" style="float: right; margin-top: -3%"></h4>
      </div>
      <div class="card-body" id="mobile_container">
        <canvas height="450" id="sending_abotie" width="800"></canvas>
      </div>
      <div class="card-footer">
        <div class="form-group" style="width: 74%">
          <select class="custom-select" id="mode-sending-recienved">
            <option selected value="Normale">
              Normale
            </option>
            <option value="Predictive">
              Predictive
            </option>
          </select>
        </div>&nbsp; <button class="btn btn-rose btn-load" id="btn-sending-recieved" type="button">load</button>
      </div>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card">
      <div class="card-header card-header-icon card-header-warning">
        <div class="card-icon">
          <i class="material-icons">bar_chart</i>
        </div>
        <h4 class="card-title">Stats Open / clic Per compane<img class="loading" id="loading-open-clic" src="{% static 'assets/img/load.gif' %}" style="float: right; margin-top: -3%"></h4>
      </div>
      <div class="card-body" id="mobile_container">
        <canvas height="450"  id="open_clic" width="800"></canvas>
      </div>
      <div class="card-footer">
        <div class="form-group" style="width: 74%">
          <select class="custom-select" id="mode-open-clic">
            <option selected value="Normale">
              Normale
            </option>
            <option value="Predictive">
              Predictive
            </option>
          </select>
        </div>&nbsp; <button id="btn-open-clic" class="btn btn-rose btn-load"  type="button">load</button>
      </div>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card">
      <div class="card-header card-header-icon card-header" >
        <div class="card-icon" style="background : #1B4F72">
          <i class="material-icons">bar_chart</i>
        </div>
        <h4 class="card-title">Stats For Each devices<img class="loading" id="loading-devices-open-clic" src="{% static 'assets/img/load.gif' %}" style="float: right; margin-top: -3%"></h4>
      </div>
      <div class="card-body" id="mobile_container">
        <canvas height="450" id="open_clic_devices" width="800"></canvas>
      </div>
      <div class="card-footer">
        <div class="form-group" style="width: 74%">
          <select class="custom-select" id="mode-open-clic-devices">
            <option selected value="Normale">
              Normale
            </option>
            <option value="Predictive">
              Predictive
            </option>
          </select>
        </div>&nbsp; <button id="btn-open-clic-devices" class="btn btn-rose btn-load" type="button">load</button>
      </div>
    </div>
  </div>
</div>
<div class="row">
  <div class="col-md-12">
    <div class="card">
      <div class="card-header card-header-primary card-header-icon">
        <div class="card-icon">
          <i class="material-icons">assignment</i>
        </div>
        <h4 class="card-title">All Analyse Created</h4>
      </div>
      <div class="card-body">
        <div class="toolbar">
          <!--        Here you can write extra buttons/actions for the toolbar              -->
        </div>
        <div class="material-datatables">
          <table cellspacing="0" class="table table-striped table-no-bordered table-hover" id="datatables_companes_analyse" style="width:100%" width="100%">
            <thead>
              <tr>
                <th>mail sending id </th>
                <th>name </th>
                <th>date Analayse</th>
                <th>Normale  </th>
                <th>Predictive  </th>
                <th>Analyse type</th>
                <th class="disabled-sorting text-right">Actions</th>
              </tr>
            </thead>
            <tfoot>
              <tr>
                <th>mail sending id </th>
                <th>name </th>
                <th>date Analayse</th>
                <th>Normale  </th>
                <th>Predictive  </th>
                <th>Analyse type</th>
                <th class="disabled-sorting text-right">Actions</th>
              </tr>
            </tfoot>
            <tbody>
            </tbody>
          </table>
        </div>
      </div><!-- end content-->
    </div><!--  end card  -->
  </div>
</div>
{% endblock %}
{% block div %}
  <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script>
  <script src="{% static 'assets/js/charts.js' %}" type="text/javascript"></script>
  <script type="text/javascript">

      var table = $('#datatables_companes_analyse').DataTable({
      dom: 'Bfrtip',
      buttons: [
          { extend: 'pdf', title: function() {
                                  var today = new Date();
                                  var date = today.getFullYear()+'-'+(today.getMonth()+1)+'-'+today.getDate();
                                  return "All Analyse On ("+date+")";
                                }, filename: function(){
                                  var today = new Date();
                                  var date = today.getFullYear()+'-'+(today.getMonth()+1)+'-'+today.getDate();
                                  return "Stats("+date+")";
                                }
          },
          { extend: 'csv' , title: function() {
                                  var today = new Date();
                                  var date = today.getFullYear()+'-'+(today.getMonth()+1)+'-'+today.getDate();
                                  return "All Analyse On ("+date+")";
                                }, filename: function(){
                                  var today = new Date();
                                  var date = today.getFullYear()+'-'+(today.getMonth()+1)+'-'+today.getDate();
                                  return "Stats("+date+")";
                                }},
          { extend: 'copy'}
      ]});
      //btn pdf
      $(".buttons-pdf").css({"background" : "#1B4F72", "color" : "white"});
      $(".buttons-pdf").html("<strong><i class='material-icons'>description</i> &nbsp;&nbsp;Export pdf</strong>");
      //btn pprint
      $(".buttons-csv").css({"background" : "#4caf50", "color" : "white", "margin-left" : "1.5%"});
      $(".buttons-csv").html("<strong><i class='fa fa-file-excel-o' aria-hidden='true' style='margin-bottom : 9px%'></i> &nbsp;&nbsp;Export csv</strong>");
      // btn copy
      $(".buttons-copy").css({"background" : "#e91e63", "color" : "white", "margin-left" : "1.5%"});
      $(".buttons-copy").html("<strong><i class='material-icons'>file_copy</i> &nbsp;&nbsp;Copy all  Data</strong>");

      $(".buttons-pdf").addClass("btn-datatable-actions");
      $(".buttons-csv").addClass("btn-datatable-actions");
      $(".buttons-copy").addClass("btn-datatable-actions");

      //$(".btn-datatable-actions").css("visibility", "hidden");
      $('#dateOption').click(function () {
        if ($('#dateOption').prop("checked")){
          $('.dataOptiontext').html("ON");
          $('.dataOptiontext').css('color' , 'green');
          $('#firstDate').attr('disabled', false);
          $('#secondDate').attr('disabled', false);
        }else{
          $('.dataOptiontext').html('OFF');
          $('.dataOptiontext').css('color' , 'red');
          $('#firstDate').attr('disabled', true);
          $('#secondDate').attr('disabled', true);
        }
      });
      $(".loading").css("visibility", "hidden");
      mail_sending_id = " {{ mail_sending_id }} ";
   	  bdname = "{{ bdname }}";
      recievedExist = false;
      normaleCharte = {"chartSend" : {{chart_sending}} , "chartRecieved" : {{ chart_recieved_inqueue }}, "chartOpenClic" : {{ chart_open_clic }} , "chartOpenDevices" : {{chart_devices_open}} , "chartClicDevices" : {{chart_devices_clic}}};
      chart_send_Recieved_inqueue = loadChartMultiple({{chart_sending}},{{ chart_recieved_inqueue }}, ["#2471A3 ", "#17A589", "#E10B0B"], ["sent ", "Recieved", 'Inqueue'], "sending_abotie", "Number Mail sending and Recieved Per compagne", 'doughnut', true);
      chart_open_clic = loadChart( {{ chart_open_clic }}, ["#52BE80", "#154360", "#3498DB "], ["recieved", "Open ", "Clic"], "open_clic", "Open / Clic Per compagne", 'horizontalBar', false);
      chart_open_clic_devices = loadBarChart(["Desktop", "Tablet", "mobile"], "Open" , "Clic", {{chart_devices_open}}, {{chart_devices_clic}}, "open_clic_devices", "#3e95cd","#8e5ea2", "Stats For Ech Tyoe Of devices");


      $('#datatables_companes_analyse').on("click", "button", function(){
        table.row($(this).parents('tr')).remove().draw(false);
        recievedExist = false;
      });
  </script>
{% endblock %}
